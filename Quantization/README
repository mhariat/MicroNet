# Quantization [STEP 4]

Before beginning STEP 4, please be sure to have a directory named "sparse_weights" in "MicroNet/Sparsity" in which you
would have put the checkpoint file of the previous sparsity step (STEP 3).

For PyramidNet only, please respect the following syntax:

"MicroNet/Sparsity/sparse_weights/pyramidnet/pyramid_noskip_back/checkpoint_run_[nb]_[acc]_[compression]_[sparsity].pth"

The name of the pth file obtained at STEP 3 during sparsity should already be in the format displayed just above. The
checkpoint file should only be put in the directory "MicroNet/Sparsity/sparse_weights/pyramidnet/pyramid_noskip_back".

For PyramidNet + SkipNet, please respect the following syntax:

"MicroNet/Sparsity/sparse_weights/pyramidskipnet/alpha_4/pyramid_skip_back/checkpoint_run_[nb]_[acc]_[compression]_[sparsity].pth"

The name of the pth file obtained at STEP 3 during sparsity should already be in the format displayed just above. The
checkpoint file should only be put in the directory "MicroNet/Sparsity/sparse_weights/pyramidskipnet/alpha_4/pyramid_skip_back".


Still in the same docker than STEP 2-3 launch the command:

CUDA_VISIBLE_DEVICES=1 python /usr/share/bind_mount/scripts/MicroNet/Quantization/main.py --config_path /usr/share/bind_mount/scripts/MicroNet/Quantization/config.json

- Be sure to complete the json file "config.json" appropriately before doing the quantization.

Here are the arguments that must be respected:

For PyramidNet only --> "exp_name": pyramidnet_noskip_back, "network": "pyramidnet"
For PyramidNet only --> "exp_name": pyramidnet_skip_back, "network": "pyramidskipnet"

You may want to change the batch_size.

The arguments "activation_bits", "activation_num_std", "weight_bits", "weight_num_std" are chosen to optimize the
results of the quantization.

In config.json, for the "checkpoint_file" argument put the checkpoint file corresponding to the result of the sparsity
step (checkpoint file format: checkpoint_run_[nb]_[acc]_[compression]_[sparsity].pth).

- Be sure to complete the json file "config.json" appropriately before applying the sparsity.


